#! /bin/sh
# apache tomee application server start/stop script
# Abdelhamid MEDDEB, Mai 2013

CATALINA_HOME="/opt/tomee"
DAEMON="$CATALINA_HOME/bin/daemon.sh"
CATALINA_ARGS="--catalina-home $CATALINA_HOME"
RETVAL=0

# start function
do_start(){
  echo "Starting tomcat..."
  $DAEMON $CATALINA_ARGS start > /dev/null
  RETVAL=$?
  if test $RETVAL -eq 0; then
      echo "OK."
    else
      echo "Error."
 fi
}

# stop function
do_stop(){
  echo "Stopping tomcat..."
  $DAEMON stop > /dev/null
  RETVAL=$?
  if test $RETVAL -eq 0; then
      echo "OK."
    else
      echo "Error."
  fi
}

# main
case "$1" in
  start)
     do_start;
     ;;
  stop)
    do_stop
    ;;
  restart)
    do_stop
    echo "wait for 10 seconds ..."
    sleep 10
    do_start
    ;;
  *)
    echo "Usage: $0 start|stop|restart" >&2
    exit 3
   ;;
esac
